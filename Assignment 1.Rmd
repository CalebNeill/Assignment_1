---
title: "R Notebook"
output: html_notebook
---

```{r}
#ensuring all necessary libraries are set before running the code
library(tidyverse)
library(readxl)
library(tidyverse)
library(janitor)
```

```{r}
#readxl commands necessary for multi-sheet excel document
data_file <- "BIOL3207_Assignment1_DataFile.xlsx"
read_xlsx(data_file, skip = 8)
```

```{r}
#creating the id names for the different sheets
site_names <- excel_sheets(data_file)
site_names
```

```{r}
#creating a list of data frames from each excel sheet
df_list <- map(set_names(excel_sheets(data_file)),
               read_excel, path = data_file)

#note the change in sheet names when converted to data frames
lapply(names(df_list), function(x)
       assign(x, df_list[[x]], envir = .GlobalEnv))
```

```{r}
#edit the first sheet in data frame form to prevent issues with the comments within the excel document
df_list[[1]] <- df_list[[1]][-c(1,2,3,4,5,6,7), ]
df_list[[1]] <- row_to_names(df_list[[1]], row_number = 1)

#add column to each data frame in list for "field site"
df_list <- mapply(cbind, df_list, "Field_Site" = site_names, SIMPLIFY = F)

df_list
```

```{r}
#combine each data frame into a single data frame
df <- rbind(df_list[[1]],df_list[[2]],df_list[[3]],df_list[[4]],df_list[[5]])

df
```

```{r}
#checking for na values in the df
na_point <- is.na(df)
colSums(na_point)
colnames(df)[colSums(is.na(df)) > 0]
```

```{r}
#check spelling of each species value
df %>% filter(!(is.na(Species))) %>% tabyl(Species, Field_Site)
```

```{r}
#replace spelling of incorrect species
which(df == "A Mendacium")
df[df == "A Mendacium"] <- "A mendacium"
```

```{r}
df %>% filter(!(is.na(Species))) %>% tabyl(Species, Field_Site)
```

```{r}

```


































