---
title: "R Notebook"
output: html_notebook
---

```{r}
#ensuring all necessary libraries are set before running the code
library(tidyverse)
library(readxl)
library(tidyverse)
library(janitor)
library(ggplot2)
library(GGally)
```

```{r}
#readxl commands necessary for multi-sheet excel document
data_file <- "BIOL3207_Assignment1_DataFile.xlsx"
read_xlsx(data_file, skip = 8)
```

```{r}
#creating the id names for the different sheets
site_names <- excel_sheets(data_file)
site_names
```

```{r}
#creating a list of data frames from each excel sheet
df_list <- map(set_names(excel_sheets(data_file)),
               read_excel, path = data_file)

#note the change in sheet names when converted to data frames
lapply(names(df_list), function(x)
       assign(x, df_list[[x]], envir = .GlobalEnv))
```

```{r}
#edit the first sheet in data frame form to prevent issues with the comments within the excel document
df_list[[1]] <- df_list[[1]][-c(1,2,3,4,5,6,7), ]
df_list[[1]] <- row_to_names(df_list[[1]], row_number = 1)

#add column to each data frame in list for "field site"
df_list <- mapply(cbind, df_list, "Field_Site" = site_names, SIMPLIFY = F)

df_list
```

```{r}
#combine each data frame into a single data frame
df <- rbind(df_list[[1]],df_list[[2]],df_list[[3]],df_list[[4]],df_list[[5]])

df
```

```{r}
#checking for na values in the df
na_point <- is.na(df)
colSums(na_point)
colnames(df)[colSums(is.na(df)) > 0]
```

```{r}
#check spelling of each species value
df %>% filter(!(is.na(Species))) %>% tabyl(Species, Field_Site)
```

```{r}
#replace spelling of incorrect species
which(df == "A Mendacium")
df[df == "A Mendacium"] <- "A mendacium"
```

```{r}
df %>% filter(!(is.na(Species))) %>% tabyl(Species, Field_Site)
```

```{r}

```

```{r}
#failed graph
df %>% filter(!(is.na(Species))) %>% filter(!(is.na(`Range (square km)`))) %>% ggplot(mapping = aes(x = Field_Site, y = `Range (square km)`, colour = Field_Site)) +
  geom_boxplot() +
  geom_smooth() +
  geom_jitter(width = 0.2, height = 0)
```

```{r}
#no correlation?
df %>% filter(!(is.na(Species))) %>% filter(!(is.na(`Range (square km)`))) %>% ggplot(mapping = aes(x = `Weight (kg)`, y = `Range (square km)`, colour = Field_Site)) + geom_point() + geom_smooth()
```

```{r}
df2 <- na.omit(df)

df2 <- mutate(df2, Species = case_when(
  df2$Species == "A fictus" ~ 1,
  df2$Species == "A mendacium" ~ 2))

df2 <- mutate(df2, Field_Site = case_when(
  df2$Field_Site == "Field Site 1" ~ 1,
  df2$Field_Site == "Field Site 2" ~ 2,
  df2$Field_Site == "Field Site 3" ~ 3,
  df2$Field_Site == "Field Site 4" ~ 4,
  df2$Field_Site == "Field Site 5" ~ 5,))

df2
```

```{r}
df_int[] <- lapply(df_int, function(x) as.numeric(as.character(x)))
df_int
sapply(df_int, class)
```

```{r}
cor(df_int[, c("Range (square km)", "Weight (kg)", "Height (cm)", "Species", "Year")])
```

```{r}
df_int %>%
  lapply(function(Species) as.character(Species)) %>%
  select(`Range (square km)`, `Weight (kg)`, `Height (cm)`, Species) %>%
  ggpairs(aes(colour = Species, alpha = 0.4))
```


















